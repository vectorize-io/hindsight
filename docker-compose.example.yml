# Hindsight Docker Compose Configuration
#
# Copy this file to docker-compose.yml and fill in your API keys:
#   cp docker-compose.example.yml docker-compose.yml
#
# Or use environment variables (recommended for production):
#   export GROQ_API_KEY=your-key
#   export GEMINI_API_KEY=your-key
#   docker-compose up -d

services:
  hindsight:
    image: hindsight-standalone
    container_name: hindsight-mcp
    ports:
      - "8888:8888"
      - "9999:9999"
    volumes:
      - hindsight-data:/home/hindsight/.pg0
    environment:
      # MCP Configuration
      - HINDSIGHT_API_MCP_ENABLED=true
      - HINDSIGHT_MCP_BANK_ID=${HINDSIGHT_BANK_ID:-default}

      # Processing LLM (Groq 120B for retain/recall)
      - HINDSIGHT_API_LLM_PROVIDER=groq
      - HINDSIGHT_API_LLM_MODEL=openai/gpt-oss-120b
      - HINDSIGHT_API_LLM_API_KEY=${GROQ_API_KEY:?Set GROQ_API_KEY environment variable}

      # Answer LLM (Gemini 3 Pro for reflect)
      - HINDSIGHT_API_ANSWER_LLM_PROVIDER=gemini
      - HINDSIGHT_API_ANSWER_LLM_MODEL=gemini-3-pro-latest
      - HINDSIGHT_API_ANSWER_LLM_API_KEY=${GEMINI_API_KEY:?Set GEMINI_API_KEY environment variable}
    restart: unless-stopped

volumes:
  # CRITICAL: This volume contains the PostgreSQL database with all memories.
  # Create with: docker volume create hindsight-data
  # NEVER delete this volume unless you want to lose all data.
  hindsight-data:
    external: true
